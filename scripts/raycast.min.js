var Engine;!function(t){var e;!function(t){t[t.Ctrl=17]="Ctrl",t[t.Alt=18]="Alt",t[t.Space=32]="Space",t[t.Left=37]="Left",t[t.Up=38]="Up",t[t.Right=39]="Right",t[t.Down=40]="Down",t[t.A=65]="A",t[t.D=68]="D",t[t.S=83]="S",t[t.W=87]="W",t[t.X=88]="X"}(e||(e={}));var i=function(){function t(){this.inputState={left:!1,right:!1,up:!1,down:!1,ctrl:!1,use:!1,fire:!1,strafeLeft:!1,strafeRight:!1,movementX:0,movementY:0},this.mouseEnabled=!1,this.events={mouseError:this.onPointerLockError.bind(this),mouseChange:this.onPointerLockChange.bind(this),mouseMove:this.onMouseMove.bind(this),mouseUp:this.onMouseUp.bind(this),mouseDown:this.onMouseDown.bind(this),keyDown:this.onKeyDown.bind(this),keyUp:this.onKeyUp.bind(this)},this.canvas=document.getElementById("screen"),document.addEventListener("keydown",this.events.keyDown),document.addEventListener("keyup",this.events.keyUp);var t=this;this.initPointerLock(this.canvas)&&(this.canvas.onclick=function(){t.registerPointerLockEvents(),t.canvas.requestPointerLock()})}return t.prototype.registerPointerLockEvents=function(){document.addEventListener("pointerlockerror",this.events.mouseError,!1),document.addEventListener("mozpointerlockerror",this.events.mouseError,!1),document.addEventListener("webkitpointerlockerror",this.events.mouseError,!1),document.addEventListener("pointerlockchange",this.events.mouseChange,!1),document.addEventListener("mozpointerlockchange",this.events.mouseChange,!1),document.addEventListener("webkitpointerlockchange",this.events.mouseChange,!1)},t.prototype.unregisterPointerLockEvents=function(){document.removeEventListener("pointerlockerror",this.events.mouseError,!1),document.removeEventListener("mozpointerlockerror",this.events.mouseError,!1),document.removeEventListener("webkitpointerlockerror",this.events.mouseError,!1),document.removeEventListener("pointerlockchange",this.events.mouseChange,!1),document.removeEventListener("mozpointerlockchange",this.events.mouseChange,!1),document.removeEventListener("webkitpointerlockchange",this.events.mouseChange,!1)},t.prototype.registerMouseEvents=function(){document.addEventListener("mousemove",this.events.mouseMove,!1),document.addEventListener("mousedown",this.events.mouseDown,!1),document.addEventListener("mouseup",this.events.mouseUp,!1)},t.prototype.unregisterMouseEvents=function(){document.removeEventListener("mousemove",this.events.mouseMove,!1),document.removeEventListener("mousedown",this.events.mouseDown,!1),document.removeEventListener("mouseup",this.events.mouseUp,!1)},t.prototype.onMouseMove=function(t){var e=t.movementX||t.mozMovementX||0,i=t.movementY||t.mozMovementY||0;this.inputState.movementX=e,this.inputState.movementY=i},t.prototype.onMouseDown=function(t){0===t.button&&(this.inputState.fire=!0)},t.prototype.onMouseUp=function(t){0===t.button&&(this.inputState.fire=!1)},t.prototype.onPointerLockChange=function(){Platform.prefix("pointerLockElement",document)===this.canvas?(this.registerMouseEvents(),this.mouseEnabled=!0):(this.unregisterMouseEvents(),this.unregisterPointerLockEvents(),this.mouseEnabled=!1,this.inputState.movementX=0,this.inputState.movementY=0)},t.prototype.onPointerLockError=function(){console.error("Failed to lock mouse")},t.prototype.initPointerLock=function(t){return Platform.prefixExists("pointerLockElement",document)?(t.requestPointerLock=Platform.prefix("requestPointerLock",t),!0):!1},t.prototype.onKeyDown=function(t){this.setKeyState(t.which,!0)},t.prototype.setKeyState=function(t,i){switch(t){case e.Ctrl:this.inputState.ctrl=i;break;case e.X:this.inputState.fire=i;break;case e.Space:this.inputState.use=i;break;case e.Left:this.inputState.left=i;break;case e.Up:case e.W:this.inputState.up=i;break;case e.Right:this.inputState.right=i;break;case e.Down:case e.S:this.inputState.down=i;break;case e.A:this.inputState.strafeLeft=i;break;case e.D:this.inputState.strafeRight=i}},t.prototype.onKeyUp=function(t){this.setKeyState(t.which,!1)},t.prototype.getState=function(){var t=Platform.shallowCopy(this.inputState);return this.inputState.movementX=0,this.inputState.movementY=0,this.inputState.use=!1,t},t}();t.Input=i}(Engine||(Engine={}));var Platform;!function(t){function e(t,e){var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=function(){e(i.response)},i.send()}function i(t,e){var i=["","webkit","moz","o","ms"];for(var s in i){var o=i[s]+t;if(o in e)return e[o]}return null}function s(t,e){var i=["","webkit","moz","o","ms"];for(var s in i){var o=i[s]+t;if(o in e)return!0}return!1}function o(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}t.log=console.log,t.requestAnimationFrame=i("requestAnimationFrame",window),t.AudioContext=i("AudioContext",window),t.exitPointerLock=i("exitPointerLock",window),t.loadFileAsArrayBuffer=e,t.prefix=i,t.prefixExists=s,t.shallowCopy=o}(Platform||(Platform={}));var Engine;!function(t){var e=function(){function t(){this.context=new Platform.AudioContext,this.mainVolume=this.context.createGain(),this.mainVolume.connect(this.context.destination)}return t.prototype.decodeAudioData=function(t,e){this.context.decodeAudioData(t,e,this.onError)},t.prototype.onError=function(){Platform.log("Failed to decode sound resource")},t.prototype.tick=function(t,e){this.setListenerPosition(t.player);for(var i=0;i<t.sounds.length;++i){var s=t.sounds[i];s.positional?this.playPositional(e.sounds[s.name],s.x,s.y,s.z):this.play(e.sounds[s.name])}},t.prototype.setListenerPosition=function(t){var e=-Math.cos(t.rotation),i=Math.sin(t.rotation),s=0;this.context.listener.setPosition(t.x,t.y,t.z),this.context.listener.setOrientation(e,i,s,0,0,1)},t.prototype.playPositional=function(t,e,i,s){var o=this.context.createPanner();o.connect(this.mainVolume),o.setPosition(e,i,s),o.refDistance=16,this.output(t,o)},t.prototype.play=function(t){this.output(t,this.mainVolume)},t.prototype.output=function(t,e){var i=this.context.createGain();i.connect(e);var s=this.context.createBufferSource();s.buffer=t,s.connect(i),s.start(0)},t}();t.SoundManager=e}(Engine||(Engine={}));var Engine;!function(t){var e=function(){function t(t,e,i,s,o){this.x=t,this.y=e,this.z=i,this.texture=s,this.color=o,this.width=32,this.height=32}return t}();t.Sprite=e}(Engine||(Engine={}));var Levels;!function(t){var e=64,i=function(){function t(){}return t.toWorldCoord=function(t){return t*e},t.toMapCoord=function(t){return Math.floor(t/e)},t}();t.MapUtil=i}(Levels||(Levels={}));var Entities;!function(t){var e=function(){function t(t){this.map=t,this.sprites=[],this.mapX=31.5,this.mapY=31.5,this.x=Levels.MapUtil.toWorldCoord(this.mapX),this.y=Levels.MapUtil.toWorldCoord(this.mapY),this.z=0,this.radius=8,this.removed=!1}return t.prototype.tryMoveTo=function(t,e,i){var s=this.x,o=this.y;this.isFree(t,o)&&(s=t),this.isFree(s,e)&&(o=e),this.setPosition(s,o,i)},t.prototype.setPosition=function(t,e,i){if(!this.removed){var s=Levels.MapUtil.toMapCoord(t),o=Levels.MapUtil.toMapCoord(e);s===this.mapX&&o===this.mapY||(this.map.getBlock(this.mapX,this.mapY).removeEntity(this),this.map.getBlock(s,o).addEntity(this)),this.x=t,this.y=e,this.z=i,this.mapX=s,this.mapY=o}},t.prototype.isFree=function(t,e){var i=this.radius,s=Levels.MapUtil.toMapCoord(t-i),o=Levels.MapUtil.toMapCoord(e-i),n=Levels.MapUtil.toMapCoord(t+i),r=Levels.MapUtil.toMapCoord(e+i);if(this.checkBlockCollision(s,o))return!1;if(this.checkBlockCollision(n,o))return!1;if(this.checkBlockCollision(s,r))return!1;if(this.checkBlockCollision(n,r))return!1;for(var a=Levels.MapUtil.toMapCoord(t),h=Levels.MapUtil.toMapCoord(e),c=1,l=h-c;h+c>=l;++l)for(var p=a-c;a+c>=p;++p)if(this.checkCollision(p,l,t,e,this.radius))return!1;return!0},t.prototype.checkBlockCollision=function(t,e){var i=this.map.getBlock(t,e);return i.passable?!1:(this.collide(i),!0)},t.prototype.checkCollision=function(t,e,i,s,o){for(var n=this.map.getBlock(t,e),r=0;r<n.entities.length;++r){var a=n.entities[r];if(a!==this&&!a.removed&&a.isTouching(this,i,s,o))return a.isTouching(this,this.x,this.y,o)||(a.collide(this),this.collide(a)),a.isBlocking(this)}return!1},t.prototype.isTouching=function(t,e,i,s){return this.x+this.radius<=e-s?!1:this.x-this.radius>=e+s?!1:this.y+this.radius<=i-s?!1:!(this.y-this.radius>=i+s)},t.prototype.isBlocking=function(t,e,i,s){return!0},t.prototype.remove=function(){this.removed=!0},t.prototype.collide=function(t){},t.prototype.tick=function(t){},t}();t.Entity=e}(Entities||(Entities={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Entities;!function(t){var e=.03,i=6,s=.1,o=function(o){function n(t){o.call(this,t),this.radius=8,this.forwardMove=0,this.sideMove=0,this.deltaMoveX=0,this.deltaMoveY=0,this.tryMoveTo(this.map.spawnPosition.x,this.map.spawnPosition.y,0),this.rotation=Math.PI/2,this.health=100,this.ammo=10,this.damageTicks=0,this.reloadTicks=0,this.weapon={texture:32,startFrame:32,frames:3},this.weaponTicks=0,this.fireing=!1,this.pickup=!1,this.hurt=!1}return __extends(n,o),n.prototype.use=function(){for(var t=this.mapX+.5,e=this.mapY+.5,i=2*Math.cos(this.rotation),s=2*-Math.sin(this.rotation),o=10,n=0;o>n;++n){var r=n/o,a=Math.floor(t+i*r),h=Math.floor(e+s*r);if(this.map.getBlock(a,h).use())break}},n.prototype.fire=function(t){this.reloadTicks<=0&&this.ammo>0&&(this.ammo-=1,this.fireing=!0,this.weapon.texture+=1,this.weaponTicks=7,this.reloadTicks=25,t.sounds.push({name:"snd_pistol_fire",positional:!1,x:this.x,y:this.y,z:this.z}),t.player.fired=!0)},n.prototype.tick=function(t){this.updateMovementVector(t),this.updatePosition(),t.player.x=this.x,t.player.y=this.y,t.player.z=this.z,t.player.rotation=this.rotation,this.damageTicks>0&&(this.damageTicks-=1),this.reloadTicks>0&&(this.reloadTicks-=1),this.weaponTicks>0?this.weaponTicks-=1:this.fireing&&(this.weapon.texture+=1,this.weapon.texture>=this.weapon.startFrame+this.weapon.frames?(this.weapon.texture=this.weapon.startFrame,this.fireing=!1):this.weaponTicks=7),t.inputState.use&&this.use(),t.inputState.fire&&this.fire(t),this.pickup&&(t.sounds.push({name:"snd_pickup",positional:!1,x:this.x,y:this.y,z:this.z}),this.pickup=!1),this.hurt&&(t.sounds.push({name:"snd_player_hurt",positional:!1,x:this.x,y:this.y,z:this.z}),this.hurt=!1)},n.prototype.updateMovementVector=function(t){t.inputState.up&&(this.forwardMove+=i),t.inputState.down&&(this.forwardMove-=i),t.inputState.strafeLeft&&(this.sideMove-=i),t.inputState.strafeRight&&(this.sideMove+=i),t.inputState.ctrl?(t.inputState.left&&(this.sideMove-=i),t.inputState.right&&(this.sideMove+=i)):(t.inputState.left&&(this.rotation+=e),t.inputState.right&&(this.rotation-=e),this.rotation%=2*Math.PI),Math.abs(t.inputState.movementX)>0&&(this.rotation-=e*s*t.inputState.movementX,this.rotation%=2*Math.PI)},n.prototype.updatePosition=function(){this.deltaMoveX=0,this.deltaMoveY=0,0!==this.forwardMove&&(this.deltaMoveX+=this.forwardMove*Math.cos(this.rotation),this.deltaMoveY-=this.forwardMove*Math.sin(this.rotation)),0!==this.sideMove&&(this.deltaMoveX+=this.sideMove*Math.sin(this.rotation),this.deltaMoveY+=this.sideMove*Math.cos(this.rotation)),0===this.deltaMoveX&&0===this.deltaMoveY||(this.tryMoveTo(this.x+this.deltaMoveX,this.y+this.deltaMoveY,this.z),this.forwardMove=0,this.sideMove=0)},n.prototype.collide=function(e){e instanceof Blocks.Block||(e instanceof t.Item?e instanceof t.HeartEntity?this.health<100&&(e.remove(),this.pickup=!0,this.health+=20,this.health>100&&(this.health=100)):e instanceof t.AmmoEntity&&this.ammo<100&&(e.remove(),this.pickup=!0,this.ammo+=10,this.ammo>100&&(this.ammo=100)):0===this.damageTicks&&(this.hurt=!0,this.damageTicks=48,this.health-=10,this.health<0&&(this.health=0)))},n.prototype.isBlocking=function(e){return e instanceof t.Item?!1:t.Entity.prototype.isBlocking.call(this,e)},n}(t.Entity);t.Player=o}(Entities||(Entities={}));var Blocks;!function(t){var e=function(){function t(){this.id=0,this.map=null,this.solid=!1,this.passable=!0,this.floorColor=23963,this.floorTexture=8,this.ceilingColor=6710886,this.ceilingTexture=17,this.texture=0,this.wallColor=16777215*Math.random(),this.sprites=[],this.entities=[]}return t.prototype.addEntity=function(t){var e=this.entities.indexOf(t);0>e&&this.entities.push(t)},t.prototype.removeEntity=function(t){var e=this.entities.indexOf(t);e>-1&&this.entities.splice(e,1)},t.prototype.use=function(){return!1},t.prototype.trigger=function(){},t}();t.Block=e}(Blocks||(Blocks={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Blocks;!function(t){var e=function(t){function e(){t.call(this),this.solid=!0,this.passable=!1,this.texture=Math.random()<.2?3:0,this.wallColor=10371141}return __extends(e,t),e}(t.Block);t.BricksBlock=e}(Blocks||(Blocks={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Blocks;!function(t){var e=function(t){function e(e,i){t.call(this),this.passable=!1,this.sprite={x:Levels.MapUtil.toWorldCoord(e+.5),y:Levels.MapUtil.toWorldCoord(i+.5),z:0,width:64,height:64,texture:27,color:8355711},this.sprites.push(this.sprite)}return __extends(e,t),e.prototype.trigger=function(){this.sprites.length>0?(this.sprites=[],this.passable=!0):(this.sprites.push(this.sprite),this.passable=!1)},e}(t.Block);t.BarsBlock=e}(Blocks||(Blocks={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Blocks;!function(t){var e=function(t){function e(){t.call(this),this.onTexture=2,this.offTexture=1,this.solid=!0,this.passable=!1,this.texture=this.offTexture,this.wallColor=10371141}return __extends(e,t),e.prototype.use=function(){return this.texture===this.offTexture?this.texture=this.onTexture:this.texture=this.offTexture,this.map.trigger(this.id),!0},e}(t.Block);t.ButtonBlock=e}(Blocks||(Blocks={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Blocks;!function(t){var e=function(t){function e(){t.call(this),this.messages=[],this.durationInTicks=-1,this.enabled=!0}return __extends(e,t),e.prototype.trigger=function(){this.enabled=!1},e}(t.Block);t.MessageBlock=e}(Blocks||(Blocks={}));var Util;!function(t){function e(t,e,i,s){var o=t-i,n=e-s;return o*o+n*n}function i(t){return"number"==typeof t?t?0>t?-1:1:t===t?0:NaN:NaN}function s(t,e,i){var s,o,n,r,a,h,c,l;if(0===e){var p=255*i;return p<<16|p<<8|p}switch(t*=6,s=Math.floor(t),o=t-s,n=255*i*(1-e),r=255*i*(1-e*o),a=255*i*(1-e*(1-o)),s){case 0:h=i,c=a,l=n;break;case 1:h=r,c=i,l=n;break;case 2:h=n,c=i,l=a;break;case 3:h=n,c=r,l=i;break;case 4:h=a,c=n,l=i;break;default:h=i,c=n,l=r}return h<<16|c<<8|l}function o(t,e,i){return t+(e-t)*i}function n(t,e,i){return Math.abs(t*Math.sin(i)-e*Math.cos(i))}function r(t,e,i){return t*Math.cos(i)+e*Math.sin(i)}t.distanceSquared=e,t.sign=i,t.hsvToRgb=s,t.lerp=o,t.pointToLineDistance=n,t.lineDistanceToPoint=r}(Util||(Util={}));var Engine;!function(t){var e=64,i=function(){function t(t,e,i){this.camera=e,this.player=i,this.map=t}return t.prototype.tick=function(t){for(var e=this.player.rotation+this.camera.fov/2,i=this.player.x,s=this.player.y,o=[],n=0;n<this.camera.view.width;++n){var r=Math.cos(e),a=Math.sin(e),h=this.castRay(t,i,s,r,-a);o.push(h),e-=this.camera.angleBetweenRays}t.intersections=o},t.prototype.castRay=function(t,i,s,o,n){var r,a,h,c,l=Levels.MapUtil.toMapCoord(i),p=Levels.MapUtil.toMapCoord(s),u=Util.sign(o),d=Util.sign(n),f=i%e,m=s%e;0>o?(r=f/-o,h=e/-o):(r=(e-f)/o,h=e/o),0>n?(a=m/-n,c=e/-n):(a=(e-m)/n,c=e/n);var v=this.map.getBlock(l,p),g=this.getSprites(v);g.length>0&&(t.sprites[p*e+l]=g);for(var y,w;;){if(a>r?(l+=u,y=h,w=0):(p+=d,y=0,w=c),v=this.map.getBlock(l,p),g=this.getSprites(v),g.length>0&&(t.sprites[p*e+l]=g),v.solid)break;r+=y,a+=w}var x,E,M;a>r?(x=i+r*o,E=s+r*n,M=E%e):(x=i+a*o,E=s+a*n,M=x%e);var k=x-i,S=E-s;return{x:x,y:E,mapX:l,mapY:p,distance:Math.sqrt(k*k+S*S),offset:M}},t.checkLine=function(t,i,s,o,n){var r=Levels.MapUtil.toMapCoord(i),a=Levels.MapUtil.toMapCoord(s),h=Levels.MapUtil.toMapCoord(o),c=Levels.MapUtil.toMapCoord(n),l=o-i,p=n-s,u=Math.sqrt(l*l+p*p);l/=u,p/=u;var d,f,m,v,g=Util.sign(l),y=Util.sign(p),w=i%e,x=s%e;0>l?(d=w/-l,m=e/-l):(d=(e-w)/l,m=e/l),0>p?(f=x/-p,v=e/-p):(f=(e-x)/p,v=e/p);var E,M;do{f>d?(r+=g,E=m,M=0):(a+=y,E=0,M=v);var k=t.getBlock(r,a);if(k.solid)return!0;d+=E,f+=M}while(r!==h&&a!==c);return!1},t.prototype.getSprites=function(t){return{sprites:t.sprites,entities:t.entities,length:t.sprites.length+t.entities.length}},t}();t.RayCaster=i}(Engine||(Engine={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Entities;!function(t){var e=function(t){function e(e){t.call(this,e),this.radius=16}return __extends(e,t),e.prototype.isBlocking=function(t,e,i,s){return!1},e}(t.Entity);t.Item=e}(Entities||(Entities={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Entities;!function(t){var e=function(t){function e(e,i,s,o){t.call(this,e),this.setPosition(i,s,0),this.radius=1,this.remove()}return __extends(e,t),e}(t.Item);t.BulletEntity=e}(Entities||(Entities={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Entities;!function(t){var e,i=40960;!function(t){t[t.IDLE=1]="IDLE",t[t.CHASE=2]="CHASE",t[t.DIE=3]="DIE"}(e||(e={}));var s;!function(t){t[t.NORMAL=1]="NORMAL",t[t.HIT=2]="HIT",t[t.DIE=3]="DIE"}(s||(s={}));var o=function(o){function n(t,i,n){o.call(this,t),this.setPosition(i,n,0),this.color=Util.hsvToRgb(Math.random(),.7,.95),this.sprites.push(new Engine.Sprite(0,0,0,24,this.color)),this.radius=12,this.mode=null,this.health=100,this.orgX=this.x,this.orgY=this.y,this.i=0,this.animState=s.NORMAL,this.animTics=0,this.currentFrame=null,this.setMode(e.IDLE)}return __extends(n,o),n.prototype.tick=function(t){this.currentFrame=t;var o=Util.distanceSquared(this.x,this.y,this.currentFrame.player.x,this.currentFrame.player.y);switch(this.mode!==e.DIE&&(i>o?this.setMode(e.CHASE):this.map.checkLine(this.x,this.y,this.currentFrame.player.x,this.currentFrame.player.y)?this.setMode(e.IDLE):this.setMode(e.CHASE)),this.mode){case e.IDLE:this.idle();break;case e.CHASE:this.follow();break;case e.DIE:}this.animState===s.HIT?4===this.animTics?(this.sprites[0].color=16711680,this.animTics-=1):this.animState>0&&(this.animTics-=1,0===this.animTics&&(this.animState=s.NORMAL)):this.animState===s.DIE?(this.sprites[0].color=16711680,this.z>-50?(this.z-=2,this.tryMoveTo(this.x,this.y,this.z)):this.removed=!0):this.animState===s.NORMAL&&(this.sprites[0].color=this.color),t.number%180===0&&Math.random()<.7&&this.breath()},n.prototype.setMode=function(t){this.mode!==t&&(t===e.IDLE?(this.orgX=this.x,this.orgY=this.y,this.i=0):t===e.CHASE&&this.breath(),this.mode=t)},n.prototype.breath=function(){null!==this.currentFrame&&this.currentFrame.sounds.push({name:"snd_ghost",positional:!0,x:this.x,y:this.y,z:this.z})},n.prototype.idle=function(){var t=this.orgX+16*Math.cos(this.i),e=this.orgY+16*Math.sin(this.i);this.tryMoveTo(t,e,this.z),this.i=this.i+.05},n.prototype.follow=function(){var t=this.currentFrame.player.x-this.x,e=this.currentFrame.player.y-this.y,i=this.x+.01*t,s=this.y+.01*e;this.tryMoveTo(i,s,this.z)},n.prototype.collide=function(i){i instanceof t.BulletEntity&&(this.health>0?(this.health-=25,this.animState=s.HIT,this.animTics=4):(this.setMode(e.DIE),this.animState=s.DIE))},n}(t.Entity);t.GhostEntity=o}(Entities||(Entities={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Entities;!function(t){var e=function(t){function e(e,i,s){t.call(this,e),this.setPosition(i,s,-22),this.sprites.push(new Engine.Sprite(0,0,0,30,14396746))}return __extends(e,t),e.prototype.tick=function(){},e}(t.Item);t.AmmoEntity=e}(Entities||(Entities={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Entities;!function(t){var e=function(t){function e(e,i,s){t.call(this,e),this.setPosition(i,s,-22),this.sprites.push(new Engine.Sprite(0,0,0,25,16711680))}return __extends(e,t),e.prototype.tick=function(){},e}(t.Item);t.HeartEntity=e}(Entities||(Entities={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Entities;!function(t){var e=function(t){function e(e,i,s){t.call(this,e),this.setPosition(i,s,-22),this.sprites.push(new Engine.Sprite(0,0,0,28,8421504))}return __extends(e,t),e.prototype.tick=function(){},e}(t.Item);t.PistolEntity=e}(Entities||(Entities={}));var Levels;!function(t){var e=64,i=function(){function t(t){this.mapSizeWidth=t.width,this.mapSizeHeight=t.height,this.spawnPosition={x:0,y:0},this.map=[],this.loadMap(t)}return t.toWorldCoord=function(t){return t*e},t.toMapCoord=function(t){return Math.floor(t/e)},t.prototype.loadMap=function(i){for(var s=this,o=0;o<s.mapSizeWidth;++o)for(var n=0;n<s.mapSizeWidth;++n){var r,a=n+s.mapSizeWidth*o,h=4*a,c=i.pixels[h+0]<<16|i.pixels[h+1]<<8|i.pixels[h+2],l=255-i.pixels[h+3];16777215===c?r=new Blocks.BricksBlock:8289918===c?r=new Blocks.BarsBlock(n,o):4653311===c?r=new Blocks.ButtonBlock:16766976===c?(r=new Blocks.MessageBlock,0===l?(r.messages.push("Where am I..."),r.messages.push("in a cell"),r.durationInTicks=100):1===l&&(r.messages.push("Hmm... a button? I wonder what it does"),r.durationInTicks=100)):(r=new Blocks.Block,16711935===c?s.spawnPosition={x:(n+.5)*e,y:(o+.5)*e}:16711680===c?r.entities.push(new Entities.GhostEntity(s,t.toWorldCoord(n+.5),t.toWorldCoord(o+.5))):65280===c?r.entities.push(new Entities.HeartEntity(s,t.toWorldCoord(n+.5),t.toWorldCoord(o+.5))):16738816===c?r.entities.push(new Entities.PistolEntity(s,t.toWorldCoord(n+.5),t.toWorldCoord(o+.5))):14396746===c&&r.entities.push(new Entities.AmmoEntity(s,t.toWorldCoord(n+.5),t.toWorldCoord(o+.5)))),r.id=l,r.map=s,s.map[a]=r}},t.prototype.hasWall=function(t,e){return this.getBlock(t,e).solid},t.prototype.getBlock=function(t,e){var i=this.map[e*this.mapSizeWidth+t];return i||new Blocks.BricksBlock},t.prototype.trigger=function(t){for(var e=0;e<this.mapSizeHeight;++e)for(var i=0;i<this.mapSizeWidth;++i){var s=this.getBlock(i,e);s.id===t&&s.trigger()}},t.prototype.checkLine=function(t,e,i,s){return Engine.RayCaster.checkLine(this,t,e,i,s)},t.prototype.checkHits=function(t){if(t.player.fired){var e=null,i=Number.MAX_VALUE;for(var s in t.sprites)for(var o=t.sprites[s],n=0;n<o.entities.length;++n){var r=o.entities[n];if(r instanceof Entities.GhostEntity){var a=r.x-t.player.x,h=r.y-t.player.y,c=Math.PI-t.player.rotation,l=Util.pointToLineDistance(a,h,c);if(l<r.radius){var p=Util.lineDistanceToPoint(a,h,-t.player.rotation);p>0&&i>p&&(i=p,e=r)}}}null!==e&&e.collide(new Entities.BulletEntity(this,e.x,e.y,t.player.rotation))}},t.prototype.tick=function(e){for(var i=0;i<this.mapSizeHeight;++i)for(var s=0;s<this.mapSizeWidth;++s){for(var o=this.getBlock(s,i),n=[],r=0;r<o.entities.length;++r){var a=o.entities[r];a.tick(e),a.removed&&n.push(r)}for(r=0;r<n.length;++r)o.entities.splice(n[r],1)}var h=this.getBlock(t.toMapCoord(e.player.x),t.toMapCoord(e.player.y));h instanceof Blocks.MessageBlock&&h.enabled&&(e.messages.push({messages:h.messages,durationInTicks:h.durationInTicks}),h.trigger())},t}();t.Map=i}(Levels||(Levels={}));var Engine;!function(t){var e=64,i=function(){function t(){this.fov=60*Math.PI/180,this.view={width:320,height:200,distance:0},this.view.distance=this.view.width/2/Math.tan(this.fov/2),this.angleBetweenRays=this.fov/this.view.width}return t}();t.Camera=i;var s=function(){function t(t,e,i,s){function o(){var t=document.getElementById("screen"),e=t.parentElement.clientWidth,i=window.innerHeight,s=e/n.camera.view.width,o=i/n.camera.view.height;n.scale=Math.min(0|s,0|o),t.width=n.camera.view.width*n.scale,t.height=n.camera.view.height*n.scale,n.context=t.getContext("2d"),n.context.imageSmoothingEnabled=!1}this.MAX_FRAME_TIME_HISTORY_LENGTH=100,this.MAX_FRAME_TIME_IN_MS=16,this.fontCache={};var n=this;this.camera=t,this.assets=e,this.displayFrameTimeGraph=!1,this.frameTimes=[],this.offCanvas=document.createElement("canvas"),this.offCanvas.width=this.camera.view.width,this.offCanvas.height=this.camera.view.height,this.offContext=this.offCanvas.getContext("2d"),this.offContext.imageSmoothingEnabled=!1,this.pixels=this.offContext.createImageData(this.camera.view.width,this.camera.view.height),this.zBuffer=new Float32Array(this.camera.view.width*this.camera.view.height),this.player=i,this.map=s,this.messages=[];var r=document.getElementById("screen");this.context=r.getContext("2d"),this.context.imageSmoothingEnabled=!1,o(),window.addEventListener("resize",o,!1),window.addEventListener("orientationchange",o,!1)}return t.prototype.toggleFullScreen=function(){var t=window.document,e=document.getElementById("screen"),i=e.requestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullScreen||e.msRequestFullscreen,s=t.exitFullscreen||t.mozCancelFullScreen||t.webkitExitFullscreen||t.msExitFullscreen;t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||t.msFullscreenElement?s.call(t):i.call(e)},t.prototype.postProcess=function(){for(var t=this.camera.view.height,e=this.camera.view.width,i=e/2,s=2*e,o=0,n=0,r=0;t>r;++r)for(var a=0;e>a;++a){var h=this.zBuffer[n++],c=this.calculateBrightness(a,r,h,e,i,s);this.pixels.data[o++]*=c,this.pixels.data[o++]*=c,this.pixels.data[o++]*=c,this.pixels.data[o++]=255}},t.prototype.calculateBrightness=function(t,e,i,s,o,n){var r=Math.abs((t-o)/s),a=6*i,h=(1&(e^t))/(100*i),c=1-r-a-a*h;return c>1?c=1:.1>c&&(c=.1),c},t.prototype.renderWalls=function(t){for(var i=this.camera.view.height,s=this.camera.view.width,o=this.camera.fov/2,n=i/2,r=e*e,a=0;a<t.length;++a){var h=t[a].distance*Math.cos(o);h>r&&(h=r);var c=h/r;c>1&&(c=1);var l=t[a].mapX,p=t[a].mapY,u=this.map.getBlock(l,p),d=this.assets.spriteSheets.img_textures[u.texture],f=(u.wallColor>>16&255)/255,m=(u.wallColor>>8&255)/255,v=(255&u.wallColor)/255,g=2*Math.ceil(e/h*i*.5),y=g;y>i?y=i:0>y&&(y=0);for(var w=t[a].offset/e*d.width,x=(g-y)/2,E=Math.ceil(n-y/2),M=4*(E*s+a),k=0;y>k;++k){var S,_=x++/g*d.height;S=this.getPixelNearest(d,w,_),this.pixels.data[M]=S.r*f,this.pixels.data[M+1]=S.g*m,this.pixels.data[M+2]=S.b*v,this.pixels.data[M+3]=255,this.zBuffer[a+(E+k)*s]=c,M+=4*s}this.renderFloor(a,E+y,o),o-=this.camera.angleBetweenRays}},t.prototype.getPixelNearest=function(t,e,i){var s=(0|e)+t.width*(0|i)<<2;return{r:t.pixels[s],g:t.pixels[s+1],b:t.pixels[s+2]}},t.prototype.getPixelBilinear=function(t,e,i){e-=.5,i-=.5;var s=0|e,o=0|i,n=e-s,r=i-o,a=1-n,h=1-r,c=4*(s+o*t.width),l=4*(s+(o+1)*t.width),p=(t.pixels[c]*a+t.pixels[c+4]*n)*h;p+=(t.pixels[l]*a+t.pixels[l+4]*n)*r,c+=1,l+=1;var u=(t.pixels[c]*a+t.pixels[c+4]*n)*h;u+=(t.pixels[l]*a+t.pixels[l+4]*n)*r,c+=1,l+=1;var d=(t.pixels[c]*a+t.pixels[c+4]*n)*h;return d+=(t.pixels[l]*a+t.pixels[l+4]*n)*r,{r:p,g:u,b:d}},t.prototype.renderFloor=function(t,e,i){for(var s=this.camera.view.height,o=this.camera.view.width,n=s/2,r=Math.cos(i+this.player.rotation),a=Math.sin(i+this.player.rotation),h=Math.cos(i),c=e;s>c;++c){var l=n/(c-n)*64,p=l/h,u=p*r+this.player.x,d=-p*a+this.player.y,f=u/64,m=d/64,v=Math.floor(m)*this.map.mapSizeWidth+Math.floor(f),g=this.map.map[v],y=this.assets.spriteSheets.img_textures[g.ceilingTexture],w=(f-(0|f))*y.width,x=(m-(0|m))*y.height,E=p/4096;E=E>1?1:E;var M=(g.ceilingColor>>16&255)/255,k=(g.ceilingColor>>8&255)/255,S=(255&g.ceilingColor)/255,_=s-c-1,T=4*(_*o+t),C=this.getPixelNearest(y,w,x);this.pixels.data[T+0]=C.r*M,this.pixels.data[T+1]=C.g*k,this.pixels.data[T+2]=C.b*S,this.pixels.data[T+3]=255,this.zBuffer[t+_*o]=E;var L=(g.floorColor>>16&255)/255,B=(g.floorColor>>8&255)/255,b=(255&g.floorColor)/255;y=this.assets.spriteSheets.img_textures[this.map.map[v].floorTexture],_=c,T=4*(_*o+t),C=this.getPixelNearest(y,w,x),this.pixels.data[T+0]=C.r*L,this.pixels.data[T+1]=C.g*B,this.pixels.data[T+2]=C.b*b,this.pixels.data[T+3]=255,this.zBuffer[t+_*o]=E}},t.prototype.renderSprites=function(t){for(var e in t.sprites){var i,s,o=t.sprites[e];for(i=0;i<o.entities.length;++i)for(var n=o.entities[i],r=0;r<n.sprites.length;++r)s=n.sprites[r],this.renderSprite(s,n.x+s.x,n.y+s.y,n.z+s.z);for(i=0;i<o.sprites.length;++i)s=o.sprites[i],this.renderSprite(s,s.x,s.y,s.z)}},t.prototype.renderSprite=function(t,e,i,s){var o=this.camera.view.width,n=this.camera.view.height,r=-e+this.player.x,a=i-this.player.y,h=-this.player.rotation,c=r*Math.sin(h)+a*Math.cos(h),l=r*Math.cos(h)-a*Math.sin(h);if(!(l>0)){var p=-l,u=p/4096;u=u>1?1:u;var d=this.assets.spriteSheets.img_textures[t.texture],f=t.width/p*o,m=t.height/p*n,v=c*o/p+o/2,g=s/p*n,y=v-f/2|0,w=n/2-m/2-g|0,x=0>y?0:y,E=0>w?0:w,M=y+f;M>o&&(M=o);var k=w+m;k>n&&(k=n);for(var S=M-x,_=k-E,T=(t.color>>16&255)/255,C=(t.color>>8&255)/255,L=(255&t.color)/255,B=0;_>B;++B){g=E+B;for(var b=0;S>b;++b){var I=x+b;if(this.zBuffer[I+g*o]>u){var P=(I-y)/f,F=(g-w)/m,A=P*d.height%d.width|0,z=F*d.height%d.height|0,R=4*(z*d.width+A),D=d.pixels[R+0],U=d.pixels[R+1],X=d.pixels[R+2];if(255===D&&0===U&&255===X)continue;var O=4*(g*o+I);this.pixels.data[O+0]=D*T,this.pixels.data[O+1]=U*C,this.pixels.data[O+2]=X*L,this.pixels.data[O+3]=d.pixels[R+3],this.zBuffer[I+g*o]=u}}}}},t.prototype.render=function(t){this.renderWalls(t.intersections),this.renderSprites(t),this.renderWeapon(),this.postProcess(),this.offContext.putImageData(this.pixels,0,0),this.renderOverlays(t),this.context.drawImage(this.offCanvas,0,0,this.camera.view.width*this.scale,this.camera.view.height*this.scale)},t.prototype.renderOverlays=function(t){if(this.messages=this.messages.concat(t.messages),this.messages.length>0){var e=this.messages[0];this.renderMessage(e.messages),e.durationInTicks-=1,e.durationInTicks<=0&&this.messages.shift()}this.drawText(5,this.camera.view.height-12,"å",255,0,0),this.drawText(14,this.camera.view.height-12,this.player.health.toString(),255,255,255),this.drawText(this.camera.view.width-34,this.camera.view.height-12,"ä",219,173,4),this.drawText(this.camera.view.width-25,this.camera.view.height-12,this.player.ammo.toString(),255,255,255),this.drawFrameTimes(t)},t.prototype.renderWeapon=function(){for(var t=this.camera.view.width,e=this.camera.view.height,i=this.assets.spriteSheets.img_textures[this.player.weapon.texture],s=4*i.width*(t/320),o=4*i.height*(e/160),n=(t-s)/2,r=e-o,a=0;o>a;++a)for(var h=r+a,c=Math.floor(a/o*i.height),l=0;s>l;++l){var p=n+l,u=Math.floor(l/s*i.width),d=4*(c*i.width+u),f=4*(h*t+p);i.pixels[d]>0&&(this.pixels.data[f]=i.pixels[d],this.pixels.data[f+1]=i.pixels[d+1],this.pixels.data[f+2]=i.pixels[d+2],this.pixels.data[f+3]=i.pixels[d+3])}},t.prototype.renderMessage=function(t){for(var e=10,i=6,s=Math.floor(this.camera.view.height/2-t.length/2*e),o=0;o<t.length;++o){var n=t[o],r=Math.floor(this.camera.view.width/2-n.length/2*i);this.drawText(r,s,n,255,255,255),s+=e}},t.prototype.drawText=function(t,e,i,s,o,n){var r=this.assets.images.img_font,a=this.getColorTintedFont(r.image,s,o,n),h="ABCDEFGHIJKLMNOPQRSTUVWXYZ.,()[]{}        abcdefghijklmnopqrstuvwxyz/\\+-=_          1234567890åä",c=6,l=8;
for(var p in i){var u=h.indexOf(i.charAt(p)),d=u%42*6,f=8*Math.floor(u/42);this.offContext.drawImage(a,d,f,6,8,t,e,c,l),t+=c}},t.prototype.enableFrameTimeGraph=function(t){this.displayFrameTimeGraph=t},t.prototype.drawFrameTimes=function(t){if(this.frameTimes.unshift(t.lastTimeInMs),this.frameTimes.length>this.MAX_FRAME_TIME_HISTORY_LENGTH&&this.frameTimes.pop(),this.displayFrameTimeGraph)for(var e=this.camera.view.width/this.MAX_FRAME_TIME_HISTORY_LENGTH,i=0,s=0;s<this.frameTimes.length;++s){var o=this.frameTimes[s];this.offContext.fillStyle="rgba(0,255,0,0.3)",this.offContext.fillRect(i,0,e,o>this.MAX_FRAME_TIME_IN_MS?this.MAX_FRAME_TIME_IN_MS:o),o>this.MAX_FRAME_TIME_IN_MS&&(this.offContext.fillStyle="rgba(255,0,0,0.3)",this.offContext.fillRect(i,this.MAX_FRAME_TIME_IN_MS,e,o-this.MAX_FRAME_TIME_IN_MS)),i+=e}},t.prototype.getColorTintedFont=function(t,e,i,s){var o="rgb("+e+","+i+","+s+")",n=null;return this.fontCache.hasOwnProperty(o)?n=this.fontCache[o]:(n=this.createColorTintedFont(t,o),this.fontCache[o]=n),n},t.prototype.createColorTintedFont=function(t,e){var i=document.createElement("canvas");i.width=t.width,i.height=t.height;var s=i.getContext("2d");s.fillStyle=e,s.fillRect(0,0,i.width,i.height),s.globalCompositeOperation="destination-atop",s.drawImage(t,0,0),s.globalCompositeOperation="darken",s.drawImage(t,0,0);var o=new Image;return o.src=i.toDataURL(),o.width=i.width,o.height=i.height,o},t}();t.Renderer=s}(Engine||(Engine={}));var Engine;!function(t){var e=function(){function t(t,e,i,s){this.pixels=i,this.width=t,this.height=e,this.image=s}return t}();t.Bitmap=e;var i=function(){function t(){}return t.prototype.loadImage=function(t,i,s,o){function n(){var t=document.createElement("canvas");t.width=r.width,t.height=r.height;var e=t.getContext("2d");return e.drawImage(r,0,0,t.width,t.height),e.getImageData(0,0,t.width,t.height).data}var r=new Image;r.addEventListener("load",function(){var t=n(),a=new e(i,s,t,r);o(a)}),r.src=t,r.width=i,r.height=s},t.prototype.loadSpriteSheet=function(t,i,s,o,n,r){function a(){var t=document.createElement("canvas");t.width=o,t.height=n;for(var r=t.getContext("2d"),a=[],c=0;i>c;c+=o)for(var l=0;s>l;l+=n){r.clearRect(0,0,t.width,t.height),r.drawImage(h,l,c,o,n,0,0,t.width,t.height);var p=new Image;p.src=t.toDataURL(),p.width=t.width,p.height=t.height;var u=r.getImageData(0,0,t.width,t.height).data;a.push(new e(o,n,u,p))}return a}var h=new Image;h.addEventListener("load",function(){var t=a();r(t)}),h.src=t,h.width=i,h.height=s},t}(),s=function(){function t(){}return t.prototype.createXorTexture=function(t,i){var s=document.createElement("canvas"),o=s.getContext("2d");s.width=t,s.height=i;for(var n=o.createImageData(t,i),r=0;i>r;++r)for(var a=0;t>a;++a){var h=(a^r)/i*255;n.data[4*(r*t+a)]=h,n.data[4*(r*t+a)+1]=h,n.data[4*(r*t+a)+2]=h,n.data[4*(r*t+a)+3]=255}return new e(t,i,n.data,null)},t}(),o=function(){function t(){this.textureLoader=new i,this.textureGenerator=new s,this.loadRequests=0,this.loadedAssets=0,this.images={},this.spriteSheets={},this.sounds={},this.callback=null;var t=this.textureGenerator.createXorTexture(16,16);this.addBitmap("xor",t)}return t.prototype.addBitmap=function(t,e){this.images[t]=e},t.prototype.addImage=function(t,e,i,s){console.log("Loading: "+e),this.loadRequests+=1;var o=this;this.textureLoader.loadImage(e,i,s,function(e){o.images[t]=e,o.onAssetLoaded(o)})},t.prototype.addSpriteSheet=function(t,e,i,s,o,n){console.log("Loading: "+e),this.loadRequests+=1;var r=this;this.textureLoader.loadSpriteSheet(e,i,s,o,n,function(e){r.spriteSheets[t]=e,r.onAssetLoaded(r)})},t.prototype.addSound=function(t,e,i){console.log("Loading: "+e),this.loadRequests+=1;var s=this;Platform.loadFileAsArrayBuffer(e,function(e){i.decodeAudioData(e,function(e){s.sounds[t]=e,s.onAssetLoaded(s)})})},t.prototype.onAssetLoaded=function(t){t.loadedAssets+=1,t.loadedAssets===t.loadRequests&&t.callback()},t.prototype.then=function(t){this.callback=t,this.loadedAssets===this.loadRequests&&(this.callback(),this.callback=null)},t}();t.AssetManager=o}(Engine||(Engine={}));var Game;!function(t){var e=function(){function t(t){this.assetPath=t}return t.prototype.run=function(){this.input=new Engine.Input,this.sound=new Engine.SoundManager,this.assets=new Engine.AssetManager,this.camera=new Engine.Camera;var t=this;this.loadAssets().then(function(){console.log("Finished loading assets"),t.start()})},t.prototype.loadAssets=function(){return this.assets.addImage("map_level1",this.assetPath+"map.png",64,64),this.assets.addImage("img_font",this.assetPath+"font.png",256,64),this.assets.addSpriteSheet("img_textures",this.assetPath+"textures.png",128,128,16,16),this.assets.addSound("snd_pistol_fire",this.assetPath+"pistol_fire.wav",this.sound),this.assets.addSound("snd_pickup",this.assetPath+"pickup.wav",this.sound),this.assets.addSound("snd_player_hurt",this.assetPath+"player_hurt.wav",this.sound),this.assets.addSound("snd_ghost",this.assetPath+"ghost.mp3",this.sound),this.assets},t.prototype.start=function(){function t(){var i={number:h++,startTime:performance.now(),endTime:null,lastTimeInMs:c,inputState:l.input.getState(),messages:[],sprites:{},player:{x:l.player.x,y:l.player.y,z:l.player.z,rotation:l.player.rotation,fired:!1},sounds:[],intersections:[]};l.map.tick(i),l.rayCaster.tick(i),l.map.checkHits(i),l.renderer.render(i),l.sound.tick(i,l.assets),window.requestAnimationFrame(t),i.endTime=performance.now(),e(i),o=i.startTime}function e(t){var e=t.startTime-o;n=.9*n+.1*(e-n);var i=1e3/(2*n);c=t.endTime-t.startTime;var h=2*c;r=.9*r+.1*(h-r),a+=1,a%100===0&&(s.updateFPS(i),s.updateWPF(r))}this.map=new Levels.Map(this.assets.images.map_level1),this.player=new Entities.Player(this.map),this.rayCaster=new Engine.RayCaster(this.map,this.camera,this.player),this.renderer=new Engine.Renderer(this.camera,this.assets,this.player,this.map);var s=new i(this.renderer),o=performance.now(),n=16,r=16,a=0,h=0,c=0,l=this;t()},t}();t.Main=e;var i=function(){function t(t){this.renderer=t,this.fpsElement=document.getElementById("fps"),this.wpfElement=document.getElementById("wpf"),this.initFullscreenElement(),this.initFrameTimeElement()}return t.prototype.initFullscreenElement=function(){this.fullscreenElement=document.getElementById("fullscreen");var t=this;this.fullscreenElement&&this.fullscreenElement.addEventListener("click",function(){t.renderer.toggleFullScreen()})},t.prototype.initFrameTimeElement=function(){if(this.frameTimeElement=document.getElementById("enableFrameTime"),this.frameTimeElement){this.frameTimeElement.checked=!1;var t=this;this.frameTimeElement.addEventListener("click",function(){t.renderer.enableFrameTimeGraph(t.frameTimeElement.checked)})}},t.prototype.updateFPS=function(t){this.fpsElement&&(this.fpsElement.innerHTML=""+t.toFixed(2))},t.prototype.updateWPF=function(t){this.wpfElement&&(this.wpfElement.innerHTML=""+t.toFixed(2))},t}()}(Game||(Game={}));
//# sourceMappingURL=maps/raycast.min.js.map
